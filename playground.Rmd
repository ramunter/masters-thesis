---
output: pdf_document
---

```{r}
corridor_names = c("index", "state",  "action", "bias", "y", "estimate")
df = read.csv("test.csv")
names(df) = corridor_names
head(df)
```

```{r}
library(ggplot2)
library(dplyr)

action_0_df = df %>% filter(action==0) 
action_1_df = df %>% filter(action==1)

ggplot(data=action_0_df) + 
    geom_point(aes(x=state, y=estimate, color=index), position=position_dodge2(width = 0.5)) + 
    scale_colour_continuous(type = 2)

ggplot(data=action_1_df) + 
    geom_point(aes(x=state, y=estimate, color=index), position=position_dodge2(width = 0.5)) + 
    scale_colour_continuous(type = 2)

```

```{r message=FALSE, warning=FALSE}
max_index = dim(df)[1]
p = ggplot()

section = 500
df$section = floor(df$index/section)
df$action = factor(df$action)

ggplot(data=df, aes(x=state, y=estimate, color=action)) + 
    facet_wrap(~section) + 
    geom_point() + 
    geom_smooth(method="loess") + 
    labs(title="Estimate")

ggplot(data=df, aes(x=state, y=y, color=action)) + 
    facet_wrap(~section) + 
    geom_point() + 
    geom_smooth(method="loess") + 
    labs(title="Target")

```